# 标签分组功能使用指南

## 功能说明

标签分组功能允许你创建**互斥标签组**，同一组内的标签只能选择一个。

## 预设标签组

应用已预设了两个标签组：

### 1. 状态组（互斥）
- 未完成
- 进行中  
- 已完成

**使用场景**：任务或笔记的完成状态，同一时刻只能处于一种状态。

### 2. 优先级组（互斥）
- 低优先级
- 中优先级
- 高优先级

**使用场景**：任务的紧急程度，只能有一个优先级。

### 3. 普通标签（可多选）
- 重要
- 紧急

**使用场景**：这些标签没有分组，可以同时选择多个。

## 使用方法

### 在编辑器中添加标签

1. 打开一个笔记
2. 点击工具栏的 **"+ 添加标签"** 按钮
3. 弹出的菜单会按组显示：
   ```
   状态
   ○ #未完成
   ○ #进行中
   ○ #已完成
   
   优先级
   ○ #高优先级
   ○ #中优先级
   ○ #低优先级
   
   其他
   ○ #重要
   ○ #紧急
   ```

4. 点击任意标签添加

### 互斥行为示例

**场景1：选择状态**
- 点击"进行中" → 添加成功
- 再点击"已完成" → 自动移除"进行中"，添加"已完成"
- 结果：只保留最后选择的"已完成"

**场景2：选择优先级**
- 点击"高优先级" → 添加成功
- 再点击"中优先级" → 自动移除"高优先级"，添加"中优先级"
- 结果：只保留"中优先级"

**场景3：普通标签**
- 点击"重要" → 添加成功
- 再点击"紧急" → 同时保留"重要"和"紧急"
- 结果：两个标签都存在

## 创建自定义标签组

### 方法1：通过标签管理界面

1. 点击左侧边栏的 **标签** 区域的 **+** 按钮
2. 在弹出的 **标签管理** 窗口中，点击 **"+ 添加标签"**
3. 输入标签名称，例如：`需求分析`
4. 在第二个输入框输入分组名，例如：`项目阶段`
5. 点击 ✓ 确认

### 方法2：创建整个标签组

创建以下标签并设置相同的分组名：

**示例：项目阶段组**
- 标签：需求分析，分组：项目阶段
- 标签：开发中，分组：项目阶段
- 标签：测试中，分组：项目阶段
- 标签：已上线，分组：项目阶段

完成后，"项目阶段"组内的标签将互斥。

## 界面展示

### 左侧边栏
标签会按组分类显示：

```
标签
────────────
状态
  #未完成
  #进行中
  #已完成

优先级
  #高优先级
  #中优先级
  #低优先级

其他
  #重要
  #紧急
```

### 笔记列表
笔记卡片会显示已添加的标签，每个标签有独特的颜色：

```
┌─────────────────────────────┐
│ 我的任务笔记                │
│ 这是笔记内容...             │
│                             │
│ #进行中 #高优先级 #重要     │
│ 🕐 今天 14:30              │
└─────────────────────────────┘
```

## 常见问题

### Q: 如果我不需要某个标签了怎么办？
A: 点击笔记工具栏标签右侧的 **×** 按钮即可移除。

### Q: 可以给同一个笔记添加多个分组的标签吗？
A: 可以！你可以同时选择"进行中"（状态组）和"高优先级"（优先级组），因为它们属于不同的组。

### Q: 普通标签和分组标签有什么区别？
A: 
- **分组标签**：同组只能选一个，适合互斥的状态（如未完成/进行中/已完成）
- **普通标签**：可以同时选多个，适合标记多个属性（如重要+紧急）

### Q: 如何知道哪些标签是分组的？
A: 在标签管理界面，分组标签会显示"分组: xxx"字样。

## 技术实现

标签分组的核心逻辑在 `Editor.tsx` 的 `toggleTag` 函数中：

```typescript
// 选择分组标签时
if (selectedTag.group) {
  // 移除同组的其他标签
  const groupTagIds = tags
    .filter(t => t.group === selectedTag.group)
    .map(t => t.id)
  newTagIds = currentNote.tagIds.filter(id => !groupTagIds.includes(id))
  newTagIds.push(tagId)
}
```

## 重要提示

⚠️ **首次使用需要清除旧数据**

如果你之前使用过应用，需要清除浏览器的localStorage才能看到新的预设标签组：

1. 打开浏览器开发者工具（F12）
2. 进入 Application（应用）标签
3. 找到 Local Storage
4. 删除所有相关数据
5. 刷新页面

或者直接在控制台运行：
```javascript
localStorage.clear()
location.reload()
```
